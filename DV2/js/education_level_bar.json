{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": "container",
  "height": 400,
  "data": {
    "url": "https://pkam0010.github.io/FIT3179/DV2/data/education_level_combined.csv"
  },
  "params": [
    {
      "name": "EducationFilter",
      "bind": {
        "input": "select",
        "options": ["All", "Basic", "Intermediate", "Advanced"],
        "labels": ["All Levels", "Basic", "Intermediate", "Advanced"],
        "name": "Education Level: "
      },
      "value": "All"
    }
  ],
  "transform": [
    {
      "filter": "datum.country == 'Australia' || datum.country == 'China' || datum.country == 'United Kingdom' || datum.country == 'United States' || datum.country == 'South Africa' || datum.country == 'Canada' || datum.country == 'Brazil' || datum.country == 'Japan' || datum.country == 'Germany' || datum.country == 'France'"
    },
    {
      "calculate": "datum.education_level == 'Basic' ? toNumber(datum.unemployment_with_basic_education) : datum.education_level == 'Intermediate' ? toNumber(datum.unemployment_with_intermediate_education) : toNumber(datum.unemployment_with_advanced_education)",
      "as": "Unemployment Rate"
    },
    {
      "filter": "(EducationFilter == 'All') || (datum.education_level == EducationFilter)"
    },
    {
      "filter": "isValid(datum['Unemployment Rate']) && datum['Unemployment Rate'] != null && !isNaN(datum['Unemployment Rate'])"
    }
  ],
  "mark": {"type": "bar", "tooltip": true},
  "encoding": {
    "x": {
      "field": "country",
      "type": "nominal",
      "title": "Country",
      "axis": {"labelAngle": -30}
    },
    "y": {
      "aggregate": "mean",
      "field": "Unemployment Rate",
      "type": "quantitative",
      "title": "Unemployment Rate (%)"
    },
    "color": {
      "field": "education_level",
      "type": "nominal",
      "title": "Education Level",
      "scale": {
        "domain": ["Basic", "Intermediate", "Advanced"],
        "range": ["#fdae61", "#abd9e9", "#2c7bb6"]
      }
    },
    "tooltip": [
      {"field": "country", "title": "Country"},
      {"field": "education_level", "title": "Education Level"},
      {"field": "Unemployment Rate", "title": "Unemployment Rate (%)", "format": ".2f"}
    ]
  },
  "config": {
    "axis": {"labelFontSize": 12, "titleFontSize": 14},
    "legend": {"titleFontSize": 14, "labelFontSize": 12}
  }
}